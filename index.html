<!DOCTYPE html>
<html>
<head>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
<link rel="stylesheet" href="./css/style.css" type="text/css" media="screen" charset="utf-8" />

<title>WebSockets Client</title>
<script type="text/javascript">
$(document).ready(function() {

    var nick = "BYKBOT";
    var ident = "maubykbotbot";
    var realname = "BOT OF BYK";

    function connect() {
        var socket;
        var host = "ws://localhost:9090/ws";

        try {
            var socket = new WebSocket(host);

            message('<p class="event">Socket Status: ' + socket.readyState);

            socket.onopen = function () {
                message('<p class="event">Socket Status: ' + socket.readyState + ' (open)');
                socket.send("NICK " + nick + "\r\n");
                socket.send("USER " + ident + ' irc.freenode.net foo :' + realname + "\r\n");
            };

            socket.onmessage = function (msg) {
                message('<p class="message">&lt; ' + msg.data);
            };

            socket.onclose = function () {
                message('<p class="event">Socket Status: ' + socket.readyState + ' (Closed)');
            };

        } catch (exception) {
            message('<p>Error' + exception);
        }

        function send() {
            var text = $('#text').val();

            if (text == "") {
                message('<p class="warning">Please enter a message');
                return;
            }
            try {
                socket.send(text + "\r\n");
                message('<p class="event">&gt; ' + text)

            } catch (exception) {
                message('<p class="warning">');
            }
            $('#text').val("");
        }

        function message(msg) {
            $('#chatLog').append(msg + '</p>');
        }

        $('#text').keypress(function (event) {
            if (event.keyCode == '13') {
                send();
            }
        });

        $('#disconnect').click(function () {
            socket.close();
        });

    }//End connect

    connect();
});
</script>

</head>
<body>
<div id="wrapper">

    <div id="container">

        <h1>WebSockets Client</h1>

        <div id="chatLog">

        </div><!-- #chatLog -->
        <p id="examples">e.g. try 'help or anything else</p>

        <input id="text" type="text" />
        <button id="disconnect">Disconnect</button>

    </div>
</div>
</body>
</html>
